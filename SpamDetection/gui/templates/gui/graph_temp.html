{% extends "base.html" %}

{% block title %}Ecran principal{% endblock %}

{% block content %}

<script>
	var jsonData = {% autoescape off %}{{ data }}{% endautoescape %}

    var margin = {top: 30, right: 40, bottom: 30, left: 50},
    width = 600 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

    var x = d3.scale.linear().domain([0, 1]).range([0, width]);
    var y = d3.scale.linear().domain([0, 1]).range([height, 0]);

    var xAxis = d3.svg.axis().scale(x).orient("bottom").ticks(5);
    var yAxis = d3.svg.axis().scale(y).orient("left").ticks(5);

    var svg = d3.select("body").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
        .style({'font-size': '10px', 'font-family': 'sans-serif',
            'font-style': 'normal', 'font-variant': 'normal', 
            'font-weight': 'normal'});

    var redraw = function(selection, data, style) {
        selection.selectAll(".bar")
            .data(data)
            .enter().append("rect")
            .attr('class', "bar")
            .attr("x", function(d) { return x(d[0]) - .5; })
            .attr("y", function(d) { return y(d[1]); })
            .attr("width", 5)
            .attr("height", function(d) { return height - y(d[1]);  })
            .style(style);

        svg.select(".x.axis").call(xAxis);
        svg.select(".y.axis").call(yAxis);
    };

    svg.append("g")            // Add the X Axis
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .style({ 'stroke': 'Black', 'fill': 'none', 'stroke-width': '1px'})
        .call(xAxis);

    svg.append("g")             
        .attr("class", "y axis")    
        .style({ 'stroke': 'Black', 'fill': 'none', 'stroke-width': '1px'})      
        .call(yAxis);

    console.log( jsonData[0].points[1]["x"] )

    // draw json points
    var pointDots = svg.selectAll('.pointDots').data(jsonData[0].points);
    pointDots.enter().append('circle').attr('class','pointDots')
      .attr('cx',function(d){ return x(d["x"]); })
      .attr('cy',function(d){ return y(d["y"]); })
      .attr("stroke", "black")
      .attr("fill", "red")
      .attr("r", function(d, i) { return 2 });
</script>

{% endblock %}